<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Blockly Playground</title>
<link href='../css/primer.css' rel='stylesheet' type='text/css'>
<link href='../css/octicons.css' rel='stylesheet' type='text/css'>
<link href='../css/dialog.css' rel='stylesheet' type='text/css'>

<script src="../lib/jquery-1.11.3.min.js"></script>
<script src="../lib/jquery-migrate-1.2.1.min.js"></script>
<script src="../lib/underscore-min.js"></script>
<script src="../lib/md5.min.js"></script>
<script src="../lib/Blob.js"></script>
<script src="../lib/FileSaver.min.js"></script>
<script src="../lib/clipboard.min.js"></script>

<script src="../../blockly/blockly_uncompressed.js"></script>

<script src="../generators/sparql.js"></script>
<script src="../core/utils.js"></script>
<script src="../core/tooltip.js"></script>
<script src="../core/prefixes.js"></script>
<script src="../core/JsonToBlocks.js"></script>
<script src="../core/exec.js"></script>
<script src="../core/types.js"></script>
<script src="../core/blocks.js"></script>
<script src="../core/storage.js"></script>
<script src="../core/msg.js"></script>
<script src="../core/field_table.js"></script>
<script src="../core/guide.js"></script>
<script src="../core/lib-dialogs.js"></script>

<script src="../generators/sparql/bgp.js"></script>
<script src="../generators/sparql/query.js"></script>
<script src="../generators/sparql/resources.js"></script>
<script src="../generators/sparql/control.js"></script>
<script src="../generators/sparql/text.js"></script>
<script src="../generators/sparql/math.js"></script>
<script src="../generators/sparql/logic.js"></script>
<script src="../generators/sparql/variables.js"></script>

<script src="../../blockly/msg/messages.js"></script>
<script src="../msg/js/en.js"></script>

<script src="../blocks/variables.js"></script>
<script src="../blocks/bgp.js"></script>
<script src="../blocks/query.js"></script>
<script src="../blocks/resources.js"></script>
<script src="../blocks/math.js"></script>
<script src="../blocks/text.js"></script>
<script src="../blocks/logic.js"></script>
<script src="../blocks/control.js"></script>
<script src="../blocks/tabular.js"></script>
<script src="../blocks/exec.js"></script>
<script src="../blocks/table.js"></script>
<script src="../blocks/test.js"></script>

<script src="../core/sparqlblocks.js"></script>

<script>
'use strict';
// Depending on the URL argument, render as LTR or RTL.
var rtl = (document.location.search == '?rtl');
var workspace = null;

function start() {

  // Blockly.Css.CONTENT = Blockly.Css.CONTENT.concat([
  //   '.blocklyText {',
  //   '  font-family: "Helvetica", sans-serif;',
  //   '}',
  //   '.blocklyTreeLabel {',
  //   '  font-family: "Helvetica", sans-serif;',
  //   '}',
  //   ''
  // ]);

  var toolbox = document.getElementById('toolbox');
  workspace = Blockly.inject('blocklyDiv', {
      comments: true,
      disable: true,
      collapse: true,
      grid:
        {spacing: 25,
         length: 3,
         colour: '#ccc',
         snap: true},
      maxBlocks: Infinity,
      media: '../../blockly/media/',
      readOnly: false,
      rtl: rtl,
      scrollbars: true,
      toolbox: toolbox,
      zoom:
        {controls: true,
         wheel: false,
         startScale: 1.0,
         maxScale: 4,
         minScale: .25,
         scaleSpeed: 1.1
        },
     });

  $('.blocklyToolboxDiv')[0].insertAdjacentHTML(
    'afterbegin',
    '<div class="main-button-container clearfix">'+
      '<div class="main-button-container clearfix">'+
      '<button class="main-button btn btn-block" disabled title="Save as Gist on GitHub" type="button" id="save-button" onclick="SparqlBlocks.Storage.linkGist()">'+
        '<span class="octicon octicon-cloud-upload"></span>'+
        ' Save as Gist'+
      '</button>'+
      '</div>'+
      '<div class="main-button-container clearfix">'+
      '<button class="main-button btn btn-block" disabled title="Copy Link to Clipboard" id="copy-button" type="button">'+
        '<span class="octicon octicon-clippy"></span>'+
        ' Copy Link'+
      '</button>'+
      '</div>'+
    '</div>');

  SparqlBlocks.Storage.setCopyOnThisButton('#copy-button');

  $('.blocklyWorkspace')[0].insertAdjacentHTML(
    'afterbegin',
    '<foreignObject x="130" y="6" width="400">'+
      '<div class="flash-messages">'+
      '</div>'+
    '</foreignObject>');

  SparqlBlocks.Storage.startup();

  // var toReplaceArray = document.getElementsByClassName("blockly-readOnly");
  // console.log(toReplaceArray);
  // var j = 0;
  // for (var i = 0; i < toReplaceArray.length; i++) {
  //   var toReplace = toReplaceArray[i];
  //   // j++;
  //   // console.log(j);
  //   // if (j > 3)
  //   //   break;
  //   console.log(toReplace);
  //   var content = toReplace.innerHTML;
  //   console.log(content);
  //   toReplace.innerHTML = "";
  //   var localWorkspace = Blockly.inject(toReplace, {'readOnly': true});
  //   console.log(localWorkspace);
  //   Blockly.Xml.domToWorkspace(localWorkspace, Blockly.Xml.textToDom("<xml>" + content + "</xml>"));
  //   console.log("inserted");
  // }

  SparqlBlocks.trackingGuide = SparqlBlocks.Guide.track(
    workspace,
    {
      // startStateId: 20,
      stateList: [
        {
          dialog: "dialogWelcome", //"Welcome to ...",
          modal: true
        },
        {
          dialog: "dialogAddQuery", //"Add a query ...",
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            if (event.type == Blockly.Events.CREATE &&
                event.block.type == "sparql_execution_endpoint_query") {
                  data.focus = event.block.getSvgRoot();
                  data.queryBlock = event.block;
                  return true;
            }
          }
        },
        {
          dialog: "dialogAddGraphPattern", //"Add a graph pattern ...",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            if (event.type == Blockly.Events.MOVE &&
                event.block.type == "sparql_typedsubject_propertylist" &&
                event.newParent &&
                event.newParent.type == "sparql_execution_endpoint_query") {
                  data.focus = event.block.getSvgRoot();
                  data.bgpBlock = event.block;
                  data.bgpBlockId = event.block.id;
                  data.varResBlockId = event.block.getInputTargetBlock("SUBJECT").id;
                  data.varTypeBlockId = event.block.getInputTargetBlock("TYPE").id;
                  data.verbObjBlock = event.block.getInputTargetBlock("PROPERTY_LIST");
                  data.verbObjBlockId = data.verbObjBlock.id;
                  data.varPredBlockId = data.verbObjBlock.getInputTargetBlock("VERB").id;
                  data.varObjBlock = data.verbObjBlock.getInputTargetBlock("OBJECT");
                  data.varObjBlockId = data.verbObjBlock.getInputTargetBlock("OBJECT").id;
                  return true;
            }
          }
        },
        {
          dialog: "dialogResults",
          style: {
            // "bottom": "30px", "right": "100px"
            "top": "10px", "right": "25px" //, "bottom": "200px"
          },
          useFocus: true
        },
        {
          dialog: "dialogVariables",
          style: {
            // "bottom": "30px", "right": "100px"
            "top": "10px", "right": "25px" //, "bottom": "200px"
          },
          useFocus: true
        },
        {
          dialog: "dialogNavigate",
          style: {
            "bottom": "25px", "left": "15px"
          },
          useFocus: true
        },
        {
          dialog: "dialogDelete",
          modal: true
        },
        {
          dialog: "dialogDeleteVar",
          style: {
            "bottom": "25px", "left": "15px"
          },
          useFocus: true,
          stepWhen: function(event, data) {
            if (event.type == Blockly.Events.DELETE &&
                event.blockId == data.varTypeBlockId &&
                !data.bgpBlock.getInputTargetBlock("TYPE")) {
                  return true;
            }
          }
        },
        {
          dialog: "dialogAddResource",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var verbBlock = data.verbObjBlock.getInputTargetBlock("VERB");
            if (verbBlock && verbBlock.type == "sparql_prefixed_iri" &&
                verbBlock.getFieldValue("PREFIX") == "foaf" &&
                verbBlock.getFieldValue("LOCAL_NAME") == "knows") {
                  data.knowsVerbObjBlock = data.verbObjBlock;
                  data.knowsBlock = verbBlock;
                  return true;
            }
          }
        },
        {
          dialog: "dialogChangeVarName",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            if (data.varObjBlock.getFieldValue("VAR") == "friend") {
              return true;
            }
          }
        },
        {
          dialog: "dialogAddBranch",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var verbObjBlock = data.bgpBlock.getInputTargetBlock("PROPERTY_LIST");
            for (;verbObjBlock; verbObjBlock = verbObjBlock.getNextBlock()) {
              if (verbObjBlock.id != data.knowsVerbObjBlock.id) {
                var verbBlock = verbObjBlock.getInputTargetBlock("VERB");
                if (verbBlock && verbBlock.type == "sparql_prefixed_iri" &&
                    verbBlock.getFieldValue("PREFIX") == "foaf" &&
                    verbBlock.getFieldValue("LOCAL_NAME") == "name") {
                      var objectBlock = verbObjBlock.getInputTargetBlock("OBJECT");
                      if (objectBlock && objectBlock.type == "variables_get" &&
                          objectBlock.getFieldValue("VAR") == "name") {
                            data.nameVerbObjBlock = verbObjBlock;
                            data.nameBlock = verbBlock;
                            data.varNameBlock = objectBlock;
                            return true;
                      }
                }
              }
            }
          }
        },
        {
          dialog: "dialogFixFromResults",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var resBlock = data.bgpBlock.getInputTargetBlock("SUBJECT");
            if (resBlock &&
                ( resBlock.type == "sparql_prefixed_iri" ||
                  resBlock.type == "sparql_iri" )) {
              data.resBlock = resBlock;
              data.resBlockId = resBlock.id;
              return true;
            }
          }
        },
        {
          dialog: "dialogAddPattern",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var patternBlock = data.queryBlock.getInputTargetBlock("WHERE");
            for (;patternBlock; patternBlock = patternBlock.getNextBlock()) {
              if (patternBlock.id != data.bgpBlock.id &&
                  patternBlock.type == "sparql_typedsubject_propertylist") {
                var resBlock = patternBlock.getInputTargetBlock("SUBJECT");
                if (resBlock && resBlock.type == "variables_get" &&
                    resBlock.getFieldValue("VAR") == "friend" ) {
                      var typeBlock = patternBlock.getInputTargetBlock("TYPE");
                      if (!typeBlock) {
                        return true;
                      }
                }
              }
            }
          }
        },
        {
          dialog: "dialogAddPattern2",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var patternBlock = data.queryBlock.getInputTargetBlock("WHERE");
            for (;patternBlock; patternBlock = patternBlock.getNextBlock()) {
              if (patternBlock.id != data.bgpBlock.id &&
                  patternBlock.type == "sparql_typedsubject_propertylist") {
                var resBlock = patternBlock.getInputTargetBlock("SUBJECT");
                if (resBlock && resBlock.type == "variables_get" &&
                    resBlock.getFieldValue("VAR") == "friend" ) {
                      var typeBlock = patternBlock.getInputTargetBlock("TYPE");
                      if (!typeBlock) {
                        var verbObjBlock = patternBlock.getInputTargetBlock("PROPERTY_LIST");
                        if (verbObjBlock && verbObjBlock.type == "sparql_verb_object") {
                          var verbBlock = verbObjBlock.getInputTargetBlock("VERB");
                          if (verbBlock && verbBlock.type == "sparql_prefixed_iri" &&
                              verbBlock.getFieldValue("PREFIX") == "foaf" &&
                              verbBlock.getFieldValue("LOCAL_NAME") == "name") {
                                var objectBlock = verbObjBlock.getInputTargetBlock("OBJECT");
                                if (objectBlock && objectBlock.type == "variables_get" &&
                                    objectBlock.getFieldValue("VAR") == "friendName") {
                                      // data.nameBlock = verbBlock;
                                      data.secondBgpBlock = patternBlock;
                                      return true;
                                }
                          }
                        }
                      }
                }
              }
            }
          }
        },
        {
          dialog: "dialogAddOrderBy",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var orderByBlock = data.queryBlock.getInputTargetBlock("ORDER_FIELD1");
            if (orderByBlock && orderByBlock.type == "variables_get" &&
                orderByBlock.getFieldValue("VAR") == "friendName" &&
                data.queryBlock.getFieldValue("ORDER_DIRECTION1") == "DESC") {
                  return true;
            }
          }
        },
        {
          dialog: "dialogChangeLimit",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var limit = data.queryBlock.getFieldValue("LIMIT");
            if (limit && limit == "3") {
              return true;
            }
          }
        },
        {
          dialog: "dialogFilter",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            var patternBlock = data.queryBlock.getInputTargetBlock("WHERE");
            for (;patternBlock; patternBlock = patternBlock.getNextBlock()) {
              if (patternBlock.id != data.bgpBlock.id &&
                  patternBlock.id != data.secondBgpBlock.id &&
                  patternBlock.type == "sparql_filter") {
                var conditionBlock = patternBlock.getInputTargetBlock("CONDITION");
                if (conditionBlock && conditionBlock.type == "sparql_text_contains") {
                  var valueBlock = conditionBlock.getInputTargetBlock("VALUE");
                  if (valueBlock && valueBlock.type == "variables_get" &&
                      valueBlock.getFieldValue("VAR") == "friendName") {
                        var findBlock = conditionBlock.getInputTargetBlock("FIND");
                        if (findBlock && findBlock.type == "sparql_text" &&
                            findBlock.getFieldValue("TEXT").toLowerCase() == "tim") {
                              return true;
                        }
                  }
                }
              }
            }
          }
        },
        {
          dialog: "dialogFindClass",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            if (event.type == Blockly.Events.CREATE &&
                event.block.type == "sparql_prefixed_iri" &&
                  event.block.getFieldValue("PREFIX") == "dbo" &&
                  event.block.getFieldValue("LOCAL_NAME") == "Lake") {
                    data.focus = event.block.getSvgRoot();
                    return true;
            }
          }
        },
        {
          dialog: "dialogFindThing",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            if (event.type == Blockly.Events.CREATE &&
                event.block.type == "sparql_prefixed_iri" &&
                  event.block.getFieldValue("PREFIX") == "dbpedia" &&
                  event.block.getFieldValue("LOCAL_NAME") == "Lake_Titicaca") {
                    // data.focus = event.block.getSvgRoot();
                    return true;
            }
          }
        },
        {
          dialog: "dialogFindProperty",
          useFocus: true,
          style: {
            "top": "10px", "right": "25px"
          },
          stepWhen: function(event, data) {
            if (event.type == Blockly.Events.CREATE &&
                event.block.type == "sparql_prefixed_iri" &&
                  event.block.getFieldValue("PREFIX") == "dbo" &&
                  event.block.getFieldValue("LOCAL_NAME") == "locatedInArea") {
                    // data.focus = event.block.getSvgRoot();
                    return true;
            }
          }
        },
        {
          dialog: "dialogSave",
          style: {
            "top": "10px", "right": "25px"
          }
        },
        {
          dialog: "dialogFinish", //"Thank you ...",
          modal: true
        },
        {
          dialog: "dialogTest",
          modal: true
        }
      ]
    }
  );

  // Restore previously displayed text.
  // var text = sessionStorage.getItem('textarea');
  // if (text) {
  //   document.getElementById('importExport').value = text;
  // }
  // taChange();
  // Restore event logging state.
  // var state = sessionStorage.getItem('logEvents');
  // logEvents(Boolean(state));

}

function toXml() {
  var output = document.getElementById('importExport');
  var xml = Blockly.Xml.workspaceToDom(workspace);
  output.value = Blockly.Xml.domToPrettyText(xml);
  output.focus();
  output.select();
  taChange();
}

function fromXml() {
  var input = document.getElementById('importExport');
  var xml = Blockly.Xml.textToDom(input.value);
  Blockly.Xml.domToWorkspace(workspace, xml);
  taChange();
}

function toCode(lang) {
  var output = document.getElementById('importExport');
  output.value = Blockly[lang].workspaceToCode(workspace);
  taChange();
}

// Disable the "Import from XML" button if the XML is invalid.
// Preserve text between page reloads.
function taChange() {
  var textarea = document.getElementById('importExport');
  sessionStorage.setItem('textarea', textarea.value)
  var valid = true;
  try {
    Blockly.Xml.textToDom(textarea.value);
  } catch (e) {
    valid = false;
  }
  document.getElementById('import').disabled = !valid;
}

function logEvents(state) {
  var checkbox = document.getElementById('logCheck');
  checkbox.checked = state;
  sessionStorage.setItem('logEvents', Number(state));
  if (state) {
    workspace.addChangeListener(logger);
  } else {
    workspace.removeChangeListener(logger);
  }
}

function logger(e) {
  console.log(e);
}

</script>

<style>
html, body {
  height: 100%;
}
body {
  background-color: #fff;
  font-family: sans-serif;
  overflow: hidden;
}
h1 {
  font-weight: normal;
  font-size: 140%;
}
#blocklyDiv {
  float: right;
  height: 100%;
  width: 100%;
}
#collaborators {
  float: right;
  width: 30px;
  margin-left: 10px;
}
#collaborators > img {
  margin-right: 5px;
  height: 30px;
  padding-bottom: 5px;
  width: 30px;
  border-radius: 3px;
}
#importExport {
  font-family: monospace;
}

.blocklyTreeRow {
  background-position: 4px 3px;
  background-repeat: no-repeat;
}

.blocklyTreeRow .blocklyTreeIconNone {
  width: 22px;
  /* background-color: #995ba5; */ /* Query */
}

.blocklyToolboxDiv .main-button-container {
  margin: 2px;
}

/*.blocklyToolboxDiv .main-button {
  margin: 1px;
}*/

.blocklyToolboxDiv #\:1 .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/gear.png'); /* Exec */
}

.blocklyToolboxDiv #\:1 .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/gear.png'); /* Exec */
}

.blocklyToolboxDiv #\:2 .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/link.png'); /* Patterns */
}

.blocklyToolboxDiv #\:2 .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/link.png'); /* Patterns */
}

.blocklyToolboxDiv #\:3 .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/tool-2.png'); /* Options */
}

.blocklyToolboxDiv #\:3 .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/tool-2.png'); /* Options */
}

.blocklyToolboxDiv #\:5 .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/tool-1.png'); /* Logic */
}

.blocklyToolboxDiv #\:5 .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/tool-1.png'); /* Logic */
}

.blocklyToolboxDiv #\:6 .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/business.png'); /* Math */
}

.blocklyToolboxDiv #\:6 .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/business.png'); /* Math */
}

.blocklyToolboxDiv #\:7 .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/signs.png'); /* Text */
}

.blocklyToolboxDiv #\:7 .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/signs.png'); /* Text */
}

.blocklyToolboxDiv #\:8 .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/business-1.png'); /* Resources */
}

.blocklyToolboxDiv #\:8 .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/business-1.png'); /* Resources */
}

.blocklyToolboxDiv #\:a .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/database.png'); /* Variables */
}

.blocklyToolboxDiv #\:a .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/database.png'); /* Variables */
}

.blocklyToolboxDiv #\:c .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/search.png'); /* Things */
}

.blocklyToolboxDiv #\:c .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/search.png'); /* Things */
}

.blocklyToolboxDiv #\:d .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/book.png'); /* Classes */
}

.blocklyToolboxDiv #\:d .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/book.png'); /* Classes */
}

.blocklyToolboxDiv #\:e .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/link-1.png'); /* Properties */
}

.blocklyToolboxDiv #\:e .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/link-1.png'); /* Properties */
}

.blocklyToolboxDiv #\:g .blocklyTreeRow {
  background-image: url('../img/menuIcons/png/mark.png'); /* Tests */
}

.blocklyToolboxDiv #\:g .blocklyTreeSelected {
  background-image: url('../img/menuIconsWhite/png/mark.png'); /* Tests */
}

</style>

</head>
<body onload="start()">

  <div id="collaborators"></div>

  <div id="blocklyDiv">
  </div>

  <xml id="toolbox" style="display: none">
    <category name="Query" colour="290">
      <block type="sparql_execution_endpoint_query"></block>
      <!-- <block type="sparql_execution_query"></block> -->
    </category>
    <category name="Patterns" colour="120">
      <block type="sparql_typedsubject_propertylist">
        <value name="SUBJECT">
          <block type="variables_get">
            <field name="VAR">res</field>
          </block>
        </value>
        <value name="TYPE">
          <block type="variables_get">
            <field name="VAR">type</field>
          </block>
        </value>
        <statement name="PROPERTY_LIST">
          <block type="sparql_verb_object">
            <value name="VERB">
              <block type="variables_get">
                <field name="VAR">pred</field>
              </block>
            </value>
            <value name="OBJECT">
              <block type="variables_get">
                <field name="VAR">obj</field>
              </block>
            </value>
          </block>
        </statement>
      </block>
      <sep gap="32"></sep>
      <block type="sparql_anonsubject_propertylist">
        <statement name="PROPERTY_LIST">
          <block type="sparql_verb_object">
            <value name="VERB">
              <block type="variables_get">
                <field name="VAR">pred</field>
              </block>
            </value>
            <value name="OBJECT">
              <block type="variables_get">
                <field name="VAR">obj</field>
              </block>
            </value>
          </block>
        </statement>
      </block>
      <sep gap="32"></sep>
      <block type="sparql_isa">
        <value name="TYPE">
          <block type="variables_get">
            <field name="VAR">type</field>
          </block>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_verb_object">
        <value name="VERB">
          <block type="variables_get">
            <field name="VAR">pred</field>
          </block>
        </value>
        <value name="OBJECT">
          <block type="variables_get">
            <field name="VAR">obj</field>
          </block>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_reversePath_object">
        <value name="OBJECT">
          <block type="variables_get">
            <field name="VAR">subj</field>
          </block>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_closurePath_object">
        <value name="VERB">
          <shadow type="sparql_prefixed_iri">
            <field name="PREFIX">rdfs</field>
            <field name="LOCAL_NAME">subClassOf</field>
          </shadow>
        </value>
        <value name="OBJECT">
          <block type="variables_get">
            <field name="VAR">to</field>
          </block>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_reverseClosurePath_object">
        <value name="VERB">
          <shadow type="sparql_prefixed_iri">
            <field name="PREFIX">rdfs</field>
            <field name="LOCAL_NAME">subClassOf</field>
          </shadow>
        </value>
        <value name="OBJECT">
          <block type="variables_get">
            <field name="VAR">from</field>
          </block>
        </value>
      </block>
    </category>
    <category name="Compose" colour="260">
      <block type="sparql_union"></block>
      <block type="sparql_optional"></block>
      <block type="sparql_graph">
        <value name="GRAPHNAME">
          <block type="variables_get">
            <field name="VAR">graph</field>
          </block>
        </value>
      </block>
    </category>
    <sep></sep>
    <category name="Logic" colour="210">
      <block type="sparql_filter"></block>

      <sep gap="32"></sep>
      <block type="sparql_logic_boolean"></block>

      <sep gap="32"></sep>
      <block type="sparql_logic_compare"></block>
      <sep gap="8"></sep>
      <block type="sparql_logic_operation"></block>
      <sep gap="8"></sep>
      <block type="sparql_logic_negate"></block>
      <!-- <block type="sparql_logic_null"></block> -->

      <sep gap="32"></sep>
      <block type="sparql_logic_ternary"></block>

      <sep gap="32"></sep>
      <block type="sparql_exists"></block>
      <sep gap="8"></sep>
      <block type="sparql_not_exists"></block>
    </category>
    <category name="Math" colour="230">
      <block type="sparql_math_number"></block>
      <sep gap="32"></sep>
      <block type="sparql_math_arithmetic">
        <value name="A">
          <shadow type="sparql_math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="B">
          <shadow type="sparql_math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_math_single">
        <value name="NUM">
          <shadow type="sparql_math_number">
            <field name="NUM">-3</field>
          </shadow>
        </value>
      </block>
      <!-- <block type="sparql_math_constant"></block> -->
      <sep gap="8"></sep>
      <block type="sparql_math_number_property">
        <value name="NUMBER_TO_CHECK">
          <shadow type="sparql_math_number">
            <field name="NUM">0</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_math_round">
        <value name="NUM">
          <shadow type="sparql_math_number">
            <field name="NUM">3.1</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_math_modulo">
        <value name="DIVIDEND">
          <shadow type="sparql_math_number">
            <field name="NUM">64</field>
          </shadow>
        </value>
        <value name="DIVISOR">
          <shadow type="sparql_math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_math_constrain">
        <value name="VALUE">
          <shadow type="sparql_math_number">
            <field name="NUM">50</field>
          </shadow>
        </value>
        <value name="LOW">
          <shadow type="sparql_math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="HIGH">
          <shadow type="sparql_math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>

      <sep gap="32"></sep>
      <block type="sparql_math_random_int">
        <value name="FROM">
          <shadow type="sparql_math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="sparql_math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_math_random_float"></block>
    </category>
    <category name="Text" colour="160">
      <block type="sparql_text"></block>
      <sep gap="8"></sep>
      <block type="sparql_text_with_lang">
        <field name="LANG">en</field>
      </block>

      <sep gap="32"></sep>
      <block type="sparql_text_join"></block>
      <sep gap="8"></sep>
      <block type="sparql_text_length">
        <value name="VALUE">
          <shadow type="sparql_text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_text_isEmpty">
        <value name="VALUE">
          <shadow type="sparql_text">
            <field name="TEXT"></field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_text_charAt">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">text</field>
          </block>
        </value>
        <value name="AT">
          <shadow type="sparql_math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_text_getSubstring">
        <value name="STRING">
          <block type="variables_get">
            <field name="VAR">text</field>
          </block>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_text_changeCase">
        <value name="TEXT">
          <shadow type="sparql_text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_text_contains">
        <value name="FIND">
          <shadow type="sparql_text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">text</field>
          </block>
        </value>
      </block>
      <!-- <block type="sparql_text_regex">
        <value name="FIND">
          <block type="sparql_text"></block>
        </value>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">text</field>
          </block>
        </value>
      </block> -->
      <sep gap="32"></sep>
      <block type="sparql_text_lang">
        <value name="LANG">
          <shadow type="sparql_text">
            <field name="TEXT">en</field>
          </shadow>
        </value>
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">text</field>
          </block>
        </value>
      </block>
      <sep gap="32"></sep>
      <block type="sparql_hash">
        <value name="TEXT">
          <shadow type="sparql_text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="Resources" colour="20">
      <block type="sparql_prefixed_iri"></block>
      <sep gap="8"></sep>
      <block type="sparql_iri"></block>
      <sep gap="32"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">rdfs</field>
        <field name="LOCAL_NAME">seeAlso</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">rdfs</field>
        <field name="LOCAL_NAME">isDefinedBy</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">rdf</field>
        <field name="LOCAL_NAME">value</field>
      </block>
      <sep gap="32"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">dcterms</field>
        <field name="LOCAL_NAME">title</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">dcterms</field>
        <field name="LOCAL_NAME">subject</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">dcterms</field>
        <field name="LOCAL_NAME">creator</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">dcterms</field>
        <field name="LOCAL_NAME">publisher</field>
      </block>
      <sep gap="32"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">foaf</field>
        <field name="LOCAL_NAME">Agent</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">foaf</field>
        <field name="LOCAL_NAME">Person</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">foaf</field>
        <field name="LOCAL_NAME">name</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">foaf</field>
        <field name="LOCAL_NAME">depiction</field>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_prefixed_iri">
        <field name="PREFIX">foaf</field>
        <field name="LOCAL_NAME">knows</field>
      </block>
    </category>
    <sep></sep>
    <category name="Variables" colour="330" custom="VARIABLE"></category>
    <sep></sep>
    <category name="Things" colour="120">
      <block type="sparql_typedsubject_propertylist">
        <value name="SUBJECT">
          <block type="variables_get">
            <field name="VAR">res</field>
          </block>
        </value>
        <value name="TYPE">
          <shadow type="sparql_prefixed_iri">
            <field name="PREFIX">owl</field>
            <field name="LOCAL_NAME">Thing</field>
          </shadow>
        </value>
        <statement name="PROPERTY_LIST">
          <block type="sparql_verb_object">
            <value name="VERB">
              <block type="sparql_prefixed_iri">
                <field name="PREFIX">rdfs</field>
                <field name="LOCAL_NAME">label</field>
              </block>
            </value>
            <value name="OBJECT">
              <block type="variables_get">
                <field name="VAR">label</field>
              </block>
            </value>
          </block>
        </statement>
        <next>
          <block type="sparql_filter">
            <value name="CONDITION">
              <block type="sparql_text_contains">
                <value name="FIND">
                  <shadow type="sparql_text_with_lang">
                    <field name="TEXT">abc</field>
                    <field name="LANG">en</field>
                  </shadow>
                </value>
                <value name="VALUE">
                  <block type="variables_get">
                    <field name="VAR">label</field>
                  </block>
                </value>
              </block>
            </value>
          </block>
        </next>
      </block>
    </category>
    <category name="Classes" colour="120">
      <block type="sparql_typedsubject_propertylist">
        <value name="SUBJECT">
          <block type="variables_get">
            <field name="VAR">type</field>
          </block>
        </value>
        <value name="TYPE">
          <block type="sparql_prefixed_iri">
            <field name="PREFIX">owl</field>
            <field name="LOCAL_NAME">Class</field>
          </block>
        </value>
        <statement name="PROPERTY_LIST">
          <block type="sparql_verb_object">
            <value name="VERB">
              <block type="sparql_prefixed_iri">
                <field name="PREFIX">rdfs</field>
                <field name="LOCAL_NAME">label</field>
              </block>
            </value>
            <value name="OBJECT">
              <block type="variables_get">
                <field name="VAR">label</field>
              </block>
            </value>
          </block>
        </statement>
        <next>
          <block type="sparql_filter">
            <value name="CONDITION">
              <block type="sparql_text_contains">
                <value name="FIND">
                  <shadow type="sparql_text_with_lang">
                    <field name="TEXT">abc</field>
                    <field name="LANG">en</field>
                  </shadow>
                </value>
                <value name="VALUE">
                  <block type="variables_get">
                    <field name="VAR">label</field>
                  </block>
                </value>
              </block>
            </value>
          </block>
        </next>
      </block>
    </category>
    <category name="Properties" colour="120">
      <block type="sparql_typedsubject_propertylist">
        <value name="SUBJECT">
          <block type="variables_get">
            <field name="VAR">property</field>
          </block>
        </value>
        <value name="TYPE">
          <block type="sparql_prefixed_iri">
            <field name="PREFIX">rdf</field>
            <field name="LOCAL_NAME">Property</field>
          </block>
        </value>
        <statement name="PROPERTY_LIST">
          <block type="sparql_verb_object">
            <value name="VERB">
              <block type="sparql_prefixed_iri">
                <field name="PREFIX">rdfs</field>
                <field name="LOCAL_NAME">label</field>
              </block>
            </value>
            <value name="OBJECT">
              <block type="variables_get">
                <field name="VAR">label</field>
              </block>
            </value>
            <next>
              <block type="sparql_verb_object">
                <value name="VERB">
                  <block type="sparql_prefixed_iri">
                    <field name="PREFIX">rdfs</field>
                    <field name="LOCAL_NAME">domain</field>
                  </block>
                </value>
                <value name="OBJECT">
                  <block type="variables_get">
                    <field name="VAR">domain</field>
                  </block>
                </value>
                <next>
                  <block type="sparql_verb_object">
                    <value name="VERB">
                      <block type="sparql_prefixed_iri">
                        <field name="PREFIX">rdfs</field>
                        <field name="LOCAL_NAME">range</field>
                      </block>
                    </value>
                    <value name="OBJECT">
                      <block type="variables_get">
                        <field name="VAR">range</field>
                      </block>
                    </value>
                  </block>
                </next>
              </block>
            </next>
          </block>
        </statement>
        <next>
          <block type="sparql_filter">
            <value name="CONDITION">
              <block type="sparql_text_contains">
                <value name="FIND">
                  <shadow type="sparql_text_with_lang">
                    <field name="TEXT">abc</field>
                    <field name="LANG">en</field>
                  </shadow>
                </value>
                <value name="VALUE">
                  <block type="variables_get">
                    <field name="VAR">label</field>
                  </block>
                </value>
              </block>
            </value>
          </block>
        </next>
      </block>
      <sep gap="32"></sep>
      <block type="sparql_typedsubject_propertylist">
        <value name="SUBJECT">
          <block type="variables_get">
            <field name="VAR">domain</field>
          </block>
        </value>
        <value name="TYPE">
          <block type="sparql_prefixed_iri">
            <field name="PREFIX">owl</field>
            <field name="LOCAL_NAME">Class</field>
          </block>
        </value>
        <statement name="PROPERTY_LIST">
          <block type="sparql_reverseClosurePath_object">
            <value name="VERB">
              <block type="sparql_prefixed_iri">
                <field name="PREFIX">rdfs</field>
                <field name="LOCAL_NAME">subClassOf</field>
              </block>
            </value>
            <value name="OBJECT">
              <shadow type="sparql_prefixed_iri">
                <field name="PREFIX">owl</field>
                <field name="LOCAL_NAME">Thing</field>
              </shadow>
            </value>
          </block>
        </statement>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_typedsubject_propertylist">
        <value name="SUBJECT">
          <block type="variables_get">
            <field name="VAR">range</field>
          </block>
        </value>
        <value name="TYPE">
          <block type="sparql_prefixed_iri">
            <field name="PREFIX">owl</field>
            <field name="LOCAL_NAME">Class</field>
          </block>
        </value>
        <statement name="PROPERTY_LIST">
          <block type="sparql_reverseClosurePath_object">
            <value name="VERB">
              <block type="sparql_prefixed_iri">
                <field name="PREFIX">rdfs</field>
                <field name="LOCAL_NAME">subClassOf</field>
              </block>
            </value>
            <value name="OBJECT">
              <shadow type="sparql_prefixed_iri">
                <field name="PREFIX">owl</field>
                <field name="LOCAL_NAME">Thing</field>
              </shadow>
            </value>
          </block>
        </statement>
      </block>
      <sep gap="8"></sep>
      <block type="sparql_typedsubject_propertylist">
        <value name="SUBJECT">
          <block type="variables_get">
            <field name="VAR">range</field>
          </block>
        </value>
        <value name="TYPE">
          <block type="sparql_prefixed_iri">
            <field name="PREFIX">rdfs</field>
            <field name="LOCAL_NAME">Datatype</field>
          </block>
        </value>
      </block>
    </category>
    <sep></sep>
    <category name="Test" colour="330">
      <block type="sparql_test">
        <data>{
          "id": "1",
          "question": "1) The DBpedia Class for mountains is",
          "answerMD5": "2bd86839cd03700675d6bcf3f34a8684"
        }</data>
      </block>
      <block type="sparql_test">
        <data>{
          "id": "2",
          "question": "2) The highest mountain (on Earth) is",
          "answerMD5": "2bd86839cd03700675d6bcf3f34a8684"
        }</data>
      </block>
      <block type="sparql_test">
        <data>{
          "id": "3",
          "question": "3) The highest mountain after the Annapurna is",
          "answerMD5": "2bd86839cd03700675d6bcf3f34a8684"
        }</data>
      </block>
      <block type="sparql_test">
        <data>{
          "id": "4",
          "question": "4) The highest mountain in Australia is ",
          "answerMD5": "6840803329d7fb45d168be3f602d0b35"
        }</data>
      </block>
      <block type="sparql_test">
        <data>{
          "id": "5",
          "question": "5) The second highest mountain (on Earth) is",
          "answerMD5": "2bd86839cd03700675d6bcf3f34a8684"
        }</data>
      </block>
    </category>
  </xml>

  <div id="dialogShadow" class="dialogAnimate"></div>
  <div id="dialogBorder"></div>
  <div id="dialog"></div>

  <div id="dialogs" class="dialogHiddenContent">
    <div id="dialogWelcome" class="dialogHiddenContent">
        <div class="dialogTitle">Welcome to SparqlBlocks</div>
        <div class="dialogContent">
          <p>
            The aim of SparqlBlocks is to let you visually build queries against <span class="dialog-def">Linked Data</span> sources.
          </p>
          <p>
            <!-- The name SparqlBlocks comes from <a href="https://www.w3.org/TR/sparql11-query/" target="_blank">SPARQL</a>, the stantard (textual) query language -->
            Although SparqlBlocks is based on
            <a href="https://www.w3.org/TR/sparql11-query/" target="_blank">SPARQL</a>
            (the standard query language for Linked Data)
            <!-- SparqlBlocks is based on SPARQL, but  -->
            you do not need to know SPARQL syntax
            to use SparqlBlocks.
          </p>
          <p>
            This tutorial will help you get started.
            Each step explains a new concept and lets you experience it in action.
          </p>
        </div>
          <!-- Follow the directions to proceed through the tutorial.</p> -->
        <div class="farSide" style="padding: 1ex 3ex 0">
          <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
        </div>
      <!-- </td></tr></table> -->
    </div>
    <div id="dialogAddQuery" style="width: 400px" class="dialogHiddenContent">
        <div class="dialogTitle">Workspace and Blocks</div>
        <div class="dialogContent">
          <p>
            The main area of the app is the <span class="dialog-def">workspace</span>.
            Here you can drag and connect together the blocks that will form queries.
          </p>
          <p>
            On the left there is the <span class="dialog-def">toolbox</span>, where you can pick the blocks to use.
            They are grouped in <span class="dialog-def">categories</span> (<span class="dialog-command">Query</span>, <span class="dialog-command">Patterns</span>,...).
          </p>
        </div>
        <div class="dialogToDo">
          <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 62px; width: 146px; float:right; display:block; margin: 3px;">
            <block x="0" y="0" type="sparql_execution_endpoint_query"></block>
          </div>
          click on the <span class="dialog-command">Query</span> category and drag the query block
          to the Workspace.
          <!-- To bring it to the workspace, you can either just click on it
          or drag it already to a specific position in the workspace. -->
        </div>
    </div>
    <div id="dialogAddGraphPattern" style="width: 400px" class="dialogHiddenContent">
        <div class="dialogTitle">Queries and Patterns</div>
        <div class="dialogContent">
          <p>
            A <span class="dialog-def">query</span> block executes queries against a
            <a href="https://www.w3.org/TR/sparql11-protocol/" target="_blank">Linked Data source</a>
            (the default source is <a href="http://dbpedia.org/" target="_blank">DBpedia</a>).
          </p>
          <p>
            Linked Data sources are graphs (networks) of concepts.
            A query is built with <span class="dialog-def">patterns</span> to be matched against the input graphs.
            <!-- Those patterns are graphs in which some nodes (concepts) are unknown. -->
            <!-- that is replaced by a Variable. -->
          </p>
        </div>
        <div class="dialogToDo">
          <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 46px; width: 146px; float:right; display:block; margin: 3px;">
            <block x="0" y="0" type="sparql_typedsubject_propertylist">
              <value name="SUBJECT">
                <block type="variables_get">
                  <field name="VAR">res</field>
                </block>
              </value>
              <value name="TYPE">
                <block type="variables_get">
                  <field name="VAR">type</field>
                </block>
              </value>
              <statement name="PROPERTY_LIST">
                <block type="sparql_verb_object">
                  <value name="VERB">
                    <block type="variables_get">
                      <field name="VAR">pred</field>
                    </block>
                  </value>
                  <value name="OBJECT">
                    <block type="variables_get">
                      <field name="VAR">obj</field>
                    </block>
                  </value>
                </block>
              </statement>
            </block>
          </div>
          from the <span class="dialog-command">Patterns</span> category,
          pick the first pattern block
          and drag it inside the query block.
          <!-- To bring it to the workspace, you can either just click on it
          or drag it already to a specific position in the workspace. -->
        </div>
    </div>
    <div id="dialogResults" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Results</div>
      <div class="dialogContent">
        <p>
          The query is remotely executed and the <span class="dialog-def">table of results</span> is shown below.
        <!-- </p>
        <p> -->
          There is a result row for each way the pattern is matched against the input graph
          (although only the first 5 rows are shown).
        </p>
        </p>
          This is a very generic pattern, that match every resource (concept)
          that has some type and is related somehow to some other resource.
        </p>
      </div>
      <div class="farSide" style="padding: 1ex 3ex 0">
        <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
      </div>
    </div>
    <div id="dialogVariables" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Variables</div>
      <div class="dialogContent">
        <p>
          The blocks
          <!-- <span class="blockly-readOnly" style="height: 26px; width: 70px;">
            <block x="8" y="0" type="variables_get"><field name="VAR">type</field></block>
          </span>,
          <span class="blockly-readOnly" style="height: 26px; width: 63px;">
            <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
          </span>,
          <span class="blockly-readOnly" style="height: 26px; width: 72px;">
            <block x="8" y="0" type="variables_get"><field name="VAR">pred</field></block>
          </span>, and
          <span class="blockly-readOnly" style="height: 26px; width: 62px;">
            <block x="8" y="0" type="variables_get"><field name="VAR">obj</field></block>
          </span> -->
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
            <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
          </span>,
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 56px; vertical-align: middle;">
            <block x="8" y="0" type="variables_get"><field name="VAR">type</field></block>
          </span>,
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 57px; vertical-align: middle;">
            <block x="8" y="0" type="variables_get"><field name="VAR">pred</field></block>
          </span>, and
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
            <block x="8" y="0" type="variables_get"><field name="VAR">obj</field></block>
          </span>
          are <span class="dialog-def">variables</span>.
          Each matching of the pattern <span class="dialog-def">binds</span> each variable to the corresponding value in the input graph.
          This value is shown under the corresponding column in the table of results.
        </p>
      </div>
      <div class="farSide" style="padding: 1ex 3ex 0">
        <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
      </div>
    </div>
    <div id="dialogNavigate" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Navigate and Zoom the Workplace</div>
      <div class="dialogContent">
        <p>
          To organize the workspace you can:
          <ol>
            <li>move blocks around by dragging them</li>
            <li>navigate the workspace
              <ul><li>by clicking on the background and dragging it or </li><li>by using the scrollbars</li></ul></li>
            <li>zoom in/out workspace
              by using <span class="icon_zoomIn"></span> and <span class="icon_zoomOut"></li>
            <li>reset workspace view
              by using <span class="icon_zoomReset"></li>
          </ol>
        </p>
      </div>
      <div class="farSide" style="padding: 1ex 3ex 0">
        <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
      </div>
    </div>
    <div id="dialogDeleteVar" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Change the Pattern</div>
      <div class="dialogContent">
        <p>
          You may change the pattern according to your needs.
          For example, remove the <span class="dialog-def">type</span> from it.
        </p>
      </div>
      <div class="dialogToDo">
        drag the variable block
        <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 56px; vertical-align: middle;">
          <block x="8" y="0" type="variables_get"><field name="VAR">type</field></block>
        </span>
        to the trash bin <span class="icon_trash"></span>.
        <!-- or right-click on the variable block and select <span class="dialog-command">Delete Block</span>. -->
      </div>
    </div>
    <div id="dialogDelete" class="dialogHiddenContent">
      <div class="dialogTitle">Delete Blocks</div>
      <div class="dialogContent">
        <p></p>
        There are three ways to delete blocks:
        <ol>
          <li>
            right-click on the variable block and select <span class="dialog-command">Delete Block</span>;
          </li>
          <li>
            drag the block to the trash bin <span class="icon_trash"></span>;
          </li>
          <li>
            drag the block to the left, over the toolbox.
          </li>
        </ol>
        <p>
          Please beware that blocks and group of blocks are deleted without prompt
          if the user accidentally drops them on the areas described (2. and 3.).</p>
        <p>
          In a not-too-far-in-the-future release we will provide an undo mechanism.</p>
      </div>
      <div class="farSide" style="padding: 1ex 3ex 0">
        <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
      </div>
    </div>
    <div id="dialogAddResource" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">From Variables to Fixed Values, Resources</div>
      <div class="dialogContent">
        <p>
          <!-- You can see that,  -->
          As the variable
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 56px; vertical-align: middle;">
            <block x="8" y="0" type="variables_get"><field name="VAR">type</field></block>
          </span>
          is not used anymore,
          the corresponding column
          disappeared from the result set.
        </p>
        <p>
          <!-- In the pattern -->
          <!-- You may replace variables with -->
          Variables may be replaced by
          <!-- To set parts of a pattern -->
          <!-- values -->
          <span class="dialog-def">resources</span> (concepts)
          <!-- like -->
          <!-- (<span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 116px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_prefixed_iri">
              <field name="PREFIX">dbpedia</field>
              <field name="LOCAL_NAME">Rome</field>
            </block>
          </span>) -->
          <!-- <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 96px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_prefixed_iri">
              <field name="PREFIX">foaf</field>
              <field name="LOCAL_NAME">knows</field>
            </block>
          </span>) -->
          <!--  -->
          and <span class="dialog-def">literals</span>
          <!-- like -->
          (strings, numbers,...),
          <!-- (<span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 77px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_text">
              <field name="TEXT">fish</field>
            </block>
          </span>,
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 37px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_math_number">
              <field name="NUM">42</field>
            </block>
          </span>), -->
          <!-- in place of variables, -->
          <!-- may replace variables in the pattern, -->
          to represent the fixed parts
           of a pattern.
        </p>
      </div>
      <div class="dialogToDo">
        from the <span class="dialog-command">Resources</span> category,
        drag the
        <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 96px; vertical-align: middle;">
          <block x="8" y="0" type="sparql_prefixed_iri">
            <field name="PREFIX">foaf</field>
            <field name="LOCAL_NAME">knows</field>
          </block>
        </span>
        resource block to the pattern,
        <!-- as the predicate ( -->
        replacing
        <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 57px; vertical-align: middle;">
          <block x="8" y="0" type="variables_get"><field name="VAR">pred</field></block>
        </span>.
      </div>
    </div>
    <div id="dialogChangeVarName" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Properties and Variable Names</div>
      <div class="dialogContent">
        <p>
          Now the query looks for pairs of resources linked by
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 96px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_prefixed_iri">
              <field name="PREFIX">foaf</field>
              <field name="LOCAL_NAME">knows</field>
            </block>
          </span>
          that is, two persons that know each other.
          Resources used to identify the type of a link, like
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 96px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_prefixed_iri">
              <field name="PREFIX">foaf</field>
              <field name="LOCAL_NAME">knows</field>
            </block>
          </span>,
          are called <span class="dialog-def">properties</span>.
        </p>
        <p>
          Variables are just placeholders,
          changing their names does not change the pattern.
        </p>
      </div>
      <div class="dialogToDo">
        click on
        <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
          <block x="8" y="0" type="variables_get"><field name="VAR">obj</field></block>
        </span>
        and <span class="dialog-command">Rename variable...</span> as
        <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 64px; vertical-align: middle;">
          <block x="8" y="0" type="variables_get"><field name="VAR">friend</field></block>
        </span>.
      </div>
      <!-- <td>
        <img src="../img/help/help.png">
      </td> -->
    </div>
    <div id="dialogAddBranch" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Grow your Pattern</div>
      <div class="dialogContent">
        <p>
          Things get interesting when patterns are composed by multiple links.
          Add a new branch to your pattern to look for the name of
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
            <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
          </span>.
        </p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 21px; width: 127px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_verb_object">
                <value name="VERB">
                  <block type="variables_get">
                    <field name="VAR">pred</field>
                  </block>
                </value>
                <value name="OBJECT">
                  <block type="variables_get">
                    <field name="VAR">obj</field>
                  </block>
                </value>
              </block>
            </div>
            from the <span class="dialog-command">Patterns</span> category,
            pick the fourth block
            and drag it inside the existing pattern; </li>
          <li>
            replace the variable
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 57px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">pred</field></block>
            </span>
            with the resource
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 92px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">foaf</field>
                <field name="LOCAL_NAME">name</field>
              </block>
            </span>; </li>
          <li>
            click on
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">obj</field></block>
            </span>
            and <span class="dialog-command">Rename variable...</span> as
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 64px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">name</field></block>
            </span>.</li>
          </ol>
      </div>
      <!-- <td>
        <img src="../img/help/help.png">
      </td> -->
    </div>
    <div id="dialogFixFromResults" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Results are Blocks too!</div>
      <div class="dialogContent">
        <p>
          The values in the table of results are also blocks,
          resources
          <!-- like -->
          <!-- (<span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 154px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_prefixed_iri">
              <field name="PREFIX">dbpedia</field>
              <field name="LOCAL_NAME">Kevin_Bacon</field>
            </block>
          </span>,
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 96px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_prefixed_iri">
              <field name="PREFIX">foaf</field>
              <field name="LOCAL_NAME">knows</field>
            </block>
          </span>) -->
          <!--  -->
          and literals.
          <!-- like -->
          <!-- (<span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 175px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_text">
              <field name="TEXT">Kevin Norwood Bacon</field>
            </block>
          </span>,
          <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 37px; vertical-align: middle;">
            <block x="8" y="0" type="sparql_math_number">
              <field name="NUM">42</field>
            </block>
          </span>). -->
          <!--  -->
          They can be used to change the current query or create new queries.
          <!-- Also the column headers are blocks, Variables. -->
        </p>
      </div>
      <div class="dialogToDo">
        from the column under the header
        <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
          <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
        </span>,
        <!-- of the table of results, -->
        drag one of the results to the pattern above,
        to replace the variable
        <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
          <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
        </span>.
        <!-- <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
          <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
        </span>. -->
      </div>
      <!-- <td>
        <img src="../img/help/help.png">
      </td> -->
    </div>
    <div id="dialogAddPattern" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Grow the Pattern Again 1/2</div>
      <div class="dialogContent">
        <p>
          The query pattern
          <!-- in a simple query like this -->
          <!-- is called a <span class="dialog-def">Basic Graph Pattern</span> and -->
          is composed of a set of star-like patterns.
          <!-- each one centered on a common subject, that can be a Resource or a Variable. -->
          <!-- By using common Variables they can be used to represent any pattern in the graph. -->
          Add another star-like pattern to get data about the friends of this person.
        </p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 46px; width: 146px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_typedsubject_propertylist">
                <value name="SUBJECT">
                  <block type="variables_get">
                    <field name="VAR">res</field>
                  </block>
                </value>
                <value name="TYPE">
                  <block type="variables_get">
                    <field name="VAR">type</field>
                  </block>
                </value>
                <statement name="PROPERTY_LIST">
                  <block type="sparql_verb_object">
                    <value name="VERB">
                      <block type="variables_get">
                        <field name="VAR">pred</field>
                      </block>
                    </value>
                    <value name="OBJECT">
                      <block type="variables_get">
                        <field name="VAR">obj</field>
                      </block>
                    </value>
                  </block>
                </statement>
              </block>
            </div>
            from the <span class="dialog-command">Patterns</span> category,
            drag again the first block,
            <!-- and drag it -->
            after the existing pattern;
            <!-- inside the existing query (before or after the existing pattern); -->
          </li>
          <li>
            click on the variable
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
            </span>
            and change it to use
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 64px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">friend</field></block>
            </span> instead; </li>
          <li>
            delete variable
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 56px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">type</field></block>
            </span>;</li>
        </ol>
      </div>
    </div>
    <div id="dialogAddPattern2" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Grow the Pattern Again 2/2</div>
      <div class="dialogContent">
        <p>
          <!-- Use the new star-like pattern to get the names of the friends. -->
          Get the name of the friends too.
        </p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 21px; width: 127px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_verb_object">
                <value name="VERB">
                  <block type="variables_get">
                    <field name="VAR">pred</field>
                  </block>
                </value>
                <value name="OBJECT">
                  <block type="variables_get">
                    <field name="VAR">obj</field>
                  </block>
                </value>
              </block>
            </div>
            delete the pre-built branch in the new star-like pattern;</li>
          <li>
            <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 21px; width: 157px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_verb_object">
                <value name="VERB">
                  <block type="sparql_prefixed_iri">
                    <field name="PREFIX">foaf</field>
                    <field name="LOCAL_NAME">name</field>
                  </block>
                </value>
                <value name="OBJECT">
                  <block type="variables_get">
                    <field name="VAR">name</field>
                  </block>
                </value>
              </block>
            </div>
            right-click on the pre-existing 'name' branch,
            <!-- of the pre-existing star-like pattern, -->
            duplicate it, and drag it inside the new star-like pattern;</li>
          <li>
            in the new copy of the branch,
            click on
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 64px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">name</field></block>
            </span>
            and choose to use a <span class="dialog-command">New variable...</span>
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 95px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">friendName</field></block>
            </span>.</li>
        </ol>
      </div>
    </div>
    <div id="dialogAddOrderBy" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Order Results</div>
      <div class="dialogContent">
        <p>
          Results by default are not given in any particular order.
          You can order them based on the content of one or more variables,
          in ascending or descending order.</p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            drag
            <!-- of the query block -->
             a copy of the variable
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 95px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">friendName</field></block>
            </span>
            (either from the <span class="dialog-command">Variables</span> category,
            from the column header in the results,
            or as duplicate of the block in the pattern)
            to the
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 26px; width: 108px; vertical-align: middle;">
              <block x="0" y="-52" type="sparql_execution_endpoint_query"></block>
            </span>
            field;
          </li>
          <li>
            change the order direction from  (asc.) to  (desc.);
            </li>
        </ol>
      </div>
    </div>
    <div id="dialogChangeLimit" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Limit Results</div>
      <div class="dialogContent">
        <p>
          <!-- You see the first 5 rows of the results. -->
          You can increase or reduce the maximum number of rows you see by changing the value of
          the <span class="dialog-def">limit</span> field.</p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            set the value of the field
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 19px; width: 110px; vertical-align: middle;">
              <block x="-147" y="-56" type="sparql_execution_endpoint_query"></block>
            </span>
            to 3.
            </li>
        </ol>
      </div>
    </div>
    <div id="dialogFilter" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Filter Results</div>
      <div class="dialogContent">
        <p>
          You can filter the results according to a logic expression of your choice.
          For example we may request to see just the friends containing the string tim in the name.</p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 21px; width: 40px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_filter"></block>
            </div>
            from the <span class="dialog-command">Logic</span> category,
            drag a filter block to the query (before, among, or after the existing patterns);
          </li>
          <li>
            <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 21px; width: 132px; float:right; display:block; margin: 3px;">
              <block x="8" y="0" type="sparql_text_contains">
                <value name="FIND">
                  <shadow type="sparql_text">
                    <field name="TEXT">abc</field>
                  </shadow>
                </value>
                <value name="VALUE">
                  <block type="variables_get">
                    <field name="VAR">text</field>
                  </block>
                </value>
              </block>
            </div>
            from the <span class="dialog-command">Text</span> category,
            drag a contains block inside the filter;
          </li>
          <li>
            change the variable
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 53px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">text</field></block>
            </span>
            to
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 95px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">friendName</field></block>
            </span>;
          </li>
          <li>
            change the text abc
            to tim.
          </li>
        </ol>
      </div>
    </div>
    <div id="dialogFindClass" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Look for Classes of Resources</div>
      <div class="dialogContent">
        <p>
          Resources have types, that are other resources.
          This resources
          <!-- that may be -->
          used as types are called <span class="dialog-def">classes</span>.</p>
        <p>
          <!-- As it is often critical to know the classes used in a dataset, -->
          There is a pre-built pattern to look for them.</p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            <!-- Delete everything the query block and all that you want from the Workspace; -->
            delete everything from the workspace;
          </li>
          <li>
            drag a new query block;
          </li>
          <li>
            <!-- <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 70px; width: 190px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_typedsubject_propertylist">
                <value name="SUBJECT">
                  <block type="variables_get">
                    <field name="VAR">type</field>
                  </block>
                </value>
                <value name="TYPE">
                  <block type="sparql_prefixed_iri">
                    <field name="PREFIX">owl</field>
                    <field name="LOCAL_NAME">Class</field>
                  </block>
                </value>
                <statement name="PROPERTY_LIST">
                  <block type="sparql_verb_object">
                    <value name="VERB">
                      <block type="sparql_prefixed_iri">
                        <field name="PREFIX">rdfs</field>
                        <field name="LOCAL_NAME">label</field>
                      </block>
                    </value>
                    <value name="OBJECT">
                      <block type="variables_get">
                        <field name="VAR">label</field>
                      </block>
                    </value>
                  </block>
                </statement>
                <next>
                  <block type="sparql_filter">
                    <value name="CONDITION">
                      <block type="sparql_text_contains">
                        <value name="FIND">
                          <shadow type="sparql_text_with_lang">
                            <field name="TEXT">abc</field>
                            <field name="LANG">en</field>
                          </shadow>
                        </value>
                        <value name="VALUE">
                          <block type="variables_get">
                            <field name="VAR">label</field>
                          </block>
                        </value>
                      </block>
                    </value>
                  </block>
                </next>
              </block>
            </div> -->
            from the <span class="dialog-command">Classes</span> category,
            drag the class block into the query;
          </li>
          <li>
            change the text abc to lake;
          </li>
          <li>
            pick from the results the class found for lakes
            <!-- from the results, drag the class found for lakes -->
            (under column
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 56px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">type</field></block>
            </span>)
            and drag it to the workspace.
            <!-- to the workspace. -->
          </li>
        </ol>
      </div>
    </div>
    <div id="dialogFindThing" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Look for Things (Resources)</div>
      <div class="dialogContent">
        <p>
          There is also a pre-built pattern to look for things (generic resources).
          Optionally you can indicate the type of the thing.
          <!-- you are looking for.</p> -->
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            right-click on resource
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 88px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">dbo</field>
                <field name="LOCAL_NAME">Lake</field>
              </block>
            </span>
            and <span class="dialog-command">Duplicate</span> it;
          </li>
          <li>
            delete everything except the two copies of
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 88px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">dbo</field>
                <field name="LOCAL_NAME">Lake</field>
              </block>
            </span>
          </li>
          <!-- <li>
            you may delete the existing blocks or not, just keep the resource
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 88px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">dbo</field>
                <field name="LOCAL_NAME">Lake</field>
              </block>
            </span>
            and <span class="dialog-command">Duplicate</span> it;
          </li> -->
          <li>
            drag a new query block;
          </li>
          <li>
            <!-- <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 70px; width: 190px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_typedsubject_propertylist">
                <value name="SUBJECT">
                  <block type="variables_get">
                    <field name="VAR">res</field>
                  </block>
                </value>
                <value name="TYPE">
                  <shadow type="sparql_prefixed_iri">
                    <field name="PREFIX">owl</field>
                    <field name="LOCAL_NAME">Thing</field>
                  </shadow>
                </value>
                <statement name="PROPERTY_LIST">
                  <block type="sparql_verb_object">
                    <value name="VERB">
                      <block type="sparql_prefixed_iri">
                        <field name="PREFIX">rdfs</field>
                        <field name="LOCAL_NAME">label</field>
                      </block>
                    </value>
                    <value name="OBJECT">
                      <block type="variables_get">
                        <field name="VAR">label</field>
                      </block>
                    </value>
                  </block>
                </statement>
                <next>
                  <block type="sparql_filter">
                    <value name="CONDITION">
                      <block type="sparql_text_contains">
                        <value name="FIND">
                          <shadow type="sparql_text_with_lang">
                            <field name="TEXT">abc</field>
                            <field name="LANG">en</field>
                          </shadow>
                        </value>
                        <value name="VALUE">
                          <block type="variables_get">
                            <field name="VAR">label</field>
                          </block>
                        </value>
                      </block>
                    </value>
                  </block>
                </next>
              </block>
            </div> -->
            from the <span class="dialog-command">Things</span> category,
            drag the thing block into the query;
          </li>
          <li>
            replace
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 90px; vertical-align: middle;">
              <shadow x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">owl</field>
                <field name="LOCAL_NAME">Thing</field>
              </shadow>
            </span>
            with
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 88px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">dbo</field>
                <field name="LOCAL_NAME">Lake</field>
              </block>
            </span>;
          </li>
          <li>
            change the text abc to titicaca;
          </li>
          <li>
            pick from the results the resource found for Lake Titicaca
            <!-- from the results, drag the resource found for Lake Titicaca -->
            (under column
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 50px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">res</field></block>
            </span>)
            and drag it to the workspace.
            <!-- to the workspace. -->
          </li>
        </ol>
      </div>
    </div>
    <div id="dialogFindProperty" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Look for Properties</div>
      <div class="dialogContent">
        <p>
          <!-- Finally, there is -->
          There is
          also a pre-built pattern to look for properties.
          You can optionally indicate
          <!-- what type of resources should be linked by the property. -->
          the class of resources from which these links come from
          the <span class="dialog-def">domain</span> and/or
          the class towards which they go to
          the <span class="dialog-def">range</span>.</p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            delete everything except
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 88px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">dbo</field>
                <field name="LOCAL_NAME">Lake</field>
              </block>
            </span>;
          </li>
          <!-- <li>
            using another query and the block in Classes,
            find also the class for rivers (look for river);
          </li> -->
          <li>
            drag a new query block;
          </li>
          <li>
            <!-- <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 70px; width: 190px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_typedsubject_propertylist">
                <value name="SUBJECT">
                  <block type="variables_get">
                    <field name="VAR">property</field>
                  </block>
                </value>
                <value name="TYPE">
                  <block type="sparql_prefixed_iri">
                    <field name="PREFIX">rdf</field>
                    <field name="LOCAL_NAME">Property</field>
                  </block>
                </value>
                <statement name="PROPERTY_LIST">
                  <block type="sparql_verb_object">
                    <value name="VERB">
                      <block type="sparql_prefixed_iri">
                        <field name="PREFIX">rdfs</field>
                        <field name="LOCAL_NAME">label</field>
                      </block>
                    </value>
                    <value name="OBJECT">
                      <block type="variables_get">
                        <field name="VAR">label</field>
                      </block>
                    </value>
                  </block>
                </statement>
                <next>
                  <block type="sparql_filter">
                    <value name="CONDITION">
                      <block type="sparql_text_contains">
                        <value name="FIND">
                          <shadow type="sparql_text_with_lang">
                            <field name="TEXT">abc</field>
                            <field name="LANG">en</field>
                          </shadow>
                        </value>
                        <value name="VALUE">
                          <block type="variables_get">
                            <field name="VAR">label</field>
                          </block>
                        </value>
                      </block>
                    </value>
                  </block>
                </next>
              </block>
            </div> -->
            from the <span class="dialog-command">Properties</span> category,
            drag the first block into the query block;
          </li>
          <li>
            <!-- <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 46px; width: 179px; float:right; display:block; margin: 3px;">
              <block x="0" y="0" type="sparql_verb_object">
                <value name="VERB">
                  <block type="sparql_prefixed_iri">
                    <field name="PREFIX">rdfs</field>
                    <field name="LOCAL_NAME">domain</field>
                  </block>
                </value>
                <value name="OBJECT">
                  <shadow type="sparql_prefixed_iri">
                    <field name="PREFIX">owl</field>
                    <field name="LOCAL_NAME">Thing</field>
                  </shadow>
                </value>
              </block>
              <block x="0" y="50" type="sparql_verb_object">
                <value name="VERB">
                  <block type="sparql_prefixed_iri">
                    <field name="PREFIX">rdfs</field>
                    <field name="LOCAL_NAME">range</field>
                  </block>
                </value>
                <value name="OBJECT">
                  <shadow type="sparql_prefixed_iri">
                    <field name="PREFIX">owl</field>
                    <field name="LOCAL_NAME">Thing</field>
                  </shadow>
                </value>
              </block>
            </div> -->
            again from the <span class="dialog-command">Properties</span> category,
            drag the second block (domain branch)
            <!-- and the third one (first range branch) -->
            after the previous one;
          </li>
          <li>
            <!-- in the domain branch, -->
            replace
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 90px; vertical-align: middle;">
              <shadow x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">owl</field>
                <field name="LOCAL_NAME">Thing</field>
              </shadow>
            </span>
            with
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 88px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">dbo</field>
                <field name="LOCAL_NAME">Lake</field>
              </block>
            </span>;
            <!-- and in the range branch
            with
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 90px; vertical-align: middle;">
              <block x="8" y="0" type="sparql_prefixed_iri">
                <field name="PREFIX">dbo</field>
                <field name="LOCAL_NAME">River</field>
              </block>
            </span>; -->
          </li>
          <li>
            change the text abc to located;
             <!-- for the property connecting lakes to rivers that bring water to them; -->
             <!-- (inflow); -->
          </li>
          <li>
            pick from the results the resource found
            (under column
            <span class="blockly-readOnly" blockly-zoom="0.8" style="height: 21px; width: 77px; vertical-align: middle;">
              <block x="8" y="0" type="variables_get"><field name="VAR">property</field></block>
            </span>)
            and drag it to the workspace.
            <!-- to the workspace. -->
          </li>
        </ol>
      </div>
    </div>
    <div id="dialogSave" style="width: 400px" class="dialogHiddenContent">
      <div class="dialogTitle">Save and Share</div>
      <div class="dialogContent">
        <p>
          You can save the current state of the Workspace anytime.
          It is associated to a link (URL) that you can share and/or keep yourself for future reference.</p>
        <p>
          Technically, the workspace content along with the history since last save/load
          is saved on <a href="https://github.com/" target="_blank">GitHub</a>
          as a secret anonymous <a href="https://help.github.com/articles/about-gists/" target="_blank">Gist</a>.
          That means access is resctricted to people having the link.</p>
      </div>
      <div class="dialogToDo">
        <ol>
          <li>
            press the
            <span class="main-button-container clearfix" style="display: inline-block; margin: 4px 0px;">
              <span class="main-button btn btn-block" style="display: inline; padding: 4px 10px;">
                <span class="octicon octicon-cloud-upload"></span>
                Save as Gist
              </span>
            </span>
            button;
          </li>
          <li>
            copy the link from the address bar of the browser
            or pressing the
            <span class="main-button-container clearfix" style="display: inline-block; margin: 4px 0px;">
              <span class="main-button btn btn-block" style="display: inline; padding: 4px 10px;">
                <span class="octicon octicon-clippy"></span>
                Copy Link
              </span>
            </span>
            button;
          </li>
          <li>
            <!-- you can save and/or share the link by pasting everywhere you want; -->
            paste the link somewhere to save and/or share it;
          </li>
          <li>
            when anyone opens that link, she/he will
            get the state of the workspace at the moment you saved it.
          </li>
          <!-- <li>
            drag a new query block;
          </li> -->
        </ol>
      </div>
      <div class="farSide" style="padding: 1ex 3ex 0">
        <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
      </div>
    </div>
    <div id="dialogFinish" class="dialogHiddenContent">
      <div class="dialogTitle">Congratulations! You learned the basics of SparqlBlocks!</div>
      <div class="dialogContent">
        <!-- <p>Good! You learned all the basics of SparqlBlocks!</p> -->
        <!-- <p> -->
          <!-- As it was not possible to cover every feature, -->
          <p></p>
          Some pointers to other useful stuff:
          <ul>
            <li>
              the <span class="dialog-command">Pattern</span> category contains
              more blocks to build patterns;
            </li>
            <li>
              the <span class="dialog-command">Compose</span> category
              contains blocks to compose patterns into complex
              queries;
            </li>
            <li>
              the categories
              <span class="dialog-command">Logic</span>,
              <span class="dialog-command">Math</span>, and
              <span class="dialog-command">Text</span>
              allow you to
              build filters
              <!-- deal  -->
              with different kinds of literals;
              <!-- and to build filters; -->
            </li>
            <li>
              the context menu (right-click) of each block has other options, like
              <ul>
                <li><span class="dialog-command">Add Comment</span> to add a note to it,</li>
                <li><span class="dialog-command">Collapse/Expand Block</span> to temporary reduce its extent,</li>
                <li><span class="dialog-command">Disable Block</span> to temporary consider it as not existent;</li>
              </ul>
            </li>
            <li>
              the context menu of a query block has the specific options
              <ul>
                <li>
                  <span class="dialog-command">Save Query as SPARQL</span>
                  to save the query as SPARQL in the local filesytem,
                </li>
                <li>
                  <span class="dialog-command">Open Query in YASGUI</span>
                  to open the query in <a href="http://yasgui.org/" target="_blank">YASGUI</a>
                  (an online SPARQL editor),
                </li>
                <li>
                  <span class="dialog-command">Save Results as JSON</span>
                  to save the results as
                  <a href="https://www.w3.org/TR/sparql11-results-json/" target="_blank">JSON</a>
                  in the local filesytem.
                </li>
              </ul>
            </li>
          </ul>
        <!-- </p> -->
      </div>
      <div class="farSide" style="padding: 1ex 3ex 0">
        <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
      </div>
    </div>
    <div id="dialogTest" class="dialogHiddenContent">
      <div class="dialogTitle">Evaluation of SparqlBlocks</div>
      <div class="dialogContent">
        <!-- <p>We appreciate you volunteered to evaluate SparqlBlocks for research purposes.</p> -->
        <!-- <p>
          Thank you very much for completing the tutorial!
          Now you are invited to attempt to achieve a small set of tasks on your own.</p> -->
        <p>
          <!-- <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 18px; width: 97px; float:right; display:block; margin: 3px;"> -->
          <div class="blockly-readOnly" blockly-zoom="0.8" style="height: 29px; width: 155px; float:right; display:block; margin: 3px;">
            <block type="sparql_test" x="0" y="0">
              <data>{
                "id": "0",
                "question": "X) The longest river is",
                "answerMD5": "b3aa0a5b32a2cf84b377a389b6250e31"
              }</data>
            </block>
          </div>
          In the category <span class="dialog-command">Test</span> there is a set of blocks that are statements
          with a missing part. Try to solve them through Linked Data queries!
        </p>
        <!-- <p> -->
          The suggested method
          <!-- we suggest to solve them, -->
          is to
          <ol>
            <li>
              retrieve
              through appropriate queries
              the needed
              <!-- necessary background -->
              resources (classes, properties, entities)
              <!-- referenced in the statement -->
              <!-- and then -->
            </li>
            <li>with the resources found in the previous step, design the query that solves the problem.</li>
          </ol>
        <!-- </p>
        <p> -->
          <!-- If you solve the tests in order not strictly required
          the results of a test may be useful for the following queries. -->
        <!-- </p> -->
        <p>
          <!-- <div class="blockly-readOnly" blockly-zoom="0.5" style="height: 19px; width: 212px; float:right; display:block; margin: 3px;"> -->
          <div class="blockly-readOnly" blockly-zoom="0.8" style="height: 30px; width: 339px; float:right; display:block; margin: 3px;">
            <block type="sparql_test" x="0" y="0">
              <data>{
                "id": "0",
                "question": "X) The longest river is",
                "answerMD5": "b3aa0a5b32a2cf84b377a389b6250e31"
              }</data>
              <value name="ANSWER">
                <block type="sparql_prefixed_iri">
                  <field name="PREFIX">dbpedia</field>
                  <field name="LOCAL_NAME">Amazon_River</field>
                </block>
              </value>
            </block>
          </div>
          When you have found the block that is the solution, drag it inside the
          corresponding test block.
          After solving as much tests as possible, save the workspace, copy the link,
          and past it back on the evaluation form.</p>
        <p>
          As the aim is to evaluate this system, please avoid using your personal
          background knowledge or external systems to solve these tests.</p>
      </div>
      <div class="farSide" style="padding: 1ex 3ex 0">
        <button class="secondary" onclick="BlocklyDialogs.hideDialog(true)">OK</button>
      </div>
    </div>
  </div>

  <!-- <h1>Blockly Playground</h1>

  <p><a href="javascript:void(workspace.setVisible(true))">Show</a>
   - <a href="javascript:void(workspace.setVisible(false))">Hide</a></p>

  <script>
    if (rtl) {
      document.write('[ &larr; RTL. Switch to <A HREF="?ltr">LTR</A>. ]');
    } else {
      document.write('[ &rarr; LTR. Switch to <A HREF="?rtl">RTL</A>. ]');
    }
  </script>

  <p>
    <input type="button" value="Export to XML" onclick="toXml()">
    &nbsp;
    <input type="button" value="Import from XML" onclick="fromXml()" id="import">
    <br>
    <input type="button" value="To JavaScript" onclick="toCode('JavaScript')">
    &nbsp;
    <input type="button" value="To Python" onclick="toCode('Python')">
    &nbsp;
    <input type="button" value="To PHP" onclick="toCode('PHP')">
    &nbsp;
    <input type="button" value="To Dart" onclick="toCode('Dart')">
    &nbsp;
    <input type="button" value="To SPARQL" onclick="toSPARQL()">
    <br>
    <textarea id="importExport" style="width: 26%; height: 12em"
      onchange="taChange();" onkeyup="taChange()"></textarea>
  </p>

  <p>
    Log events: &nbsp;
    <input type="checkbox" onclick="logEvents(this.checked)" id="logCheck">
  </p> -->

</body>
</html>
